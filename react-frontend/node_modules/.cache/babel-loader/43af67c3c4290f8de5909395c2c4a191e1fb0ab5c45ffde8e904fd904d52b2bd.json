{"ast":null,"code":"import _slicedToArray from\"/Users/hackyourfuture/Desktop/reactWorkSpace/react-ecommerce/react-ecommerce/react-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useContext,useEffect,useState}from\"react\";import{deleteCookie}from\"../helpers/cookiesHelpers\";import{fetchApi}from\"../helpers/fetchHelper\";import{OrderInProcessContext}from\"../contexts/OrderInProcessContext\";import loadingBar from\"../assets/loading-svgrepo-com.svg\";import{apiServer}from\"../environmentVariables\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function PaymentReturnPage(_ref){var errorHandler=_ref.errorHandler;var _useContext=useContext(OrderInProcessContext),orderContext=_useContext.orderContext,handleOrderContext=_useContext.handleOrderContext;var _useState=useState(\"pending\"),_useState2=_slicedToArray(_useState,2),orderStatus=_useState2[0],setOrderStatus=_useState2[1];useEffect(function(){var intervalId=setInterval(function(){fetchApi(\"\".concat(apiServer,\"/api/checkout/status/\").concat(orderContext.id)).then(function(res){if(res.order_status===\"closed\"){setOrderStatus(res.payment_status);deleteCookie(\"orderInProcess\");clearInterval(intervalId);}}).catch(function(err){return errorHandler(err);});},5000);},[]);var totalQuantity=0;var cartItems=orderContext?orderContext.Products.map(function(product){totalQuantity+=product.OrderDetail.quantity;return/*#__PURE__*/_jsxs(\"div\",{className:\"cart-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"cart-item-left\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"cart-product-image\",src:\"\".concat(apiServer,\"/api/productImages/\").concat(product.ProductImages[0].path.split(\"/\")[3]),alt:product.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart-update\",children:[/*#__PURE__*/_jsx(\"p\",{children:product.name}),/*#__PURE__*/_jsx(\"span\",{children:product.OrderDetail.quantity})]})]}),/*#__PURE__*/_jsx(\"span\",{className:\"cart-product-price\",children:product.price})]});}):[];return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"navbar-space\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"order-detail\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Thank you for your shopping...\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Order Id: \".concat(orderContext.id)}),/*#__PURE__*/_jsx(\"p\",{children:orderContext.GuestCustomer.firstName}),/*#__PURE__*/_jsx(\"p\",{children:orderContext.GuestCustomer.lastName})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart-items\",children:[cartItems,/*#__PURE__*/_jsxs(\"div\",{className:\"cart-total-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"cart-total\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"Total (\",\"\".concat(totalQuantity,\" products\"),\")\"]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"(\",\"\".concat(orderContext.order_total,\"$\"),\")\"]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"payment-status\",children:\"Payment status\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"p\",{className:\"payment-status\",children:[\" \",orderStatus===\"pending\"?/*#__PURE__*/_jsx(\"img\",{class:\"loading-bar\",src:loadingBar,alt:\"loading-bar\"}):orderStatus]})]})]})]});}","map":{"version":3,"names":["React","useContext","useEffect","useState","deleteCookie","fetchApi","OrderInProcessContext","loadingBar","apiServer","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","PaymentReturnPage","_ref","errorHandler","_useContext","orderContext","handleOrderContext","_useState","_useState2","_slicedToArray","orderStatus","setOrderStatus","intervalId","setInterval","concat","id","then","res","order_status","payment_status","clearInterval","catch","err","totalQuantity","cartItems","Products","map","product","OrderDetail","quantity","className","children","src","ProductImages","path","split","alt","name","price","GuestCustomer","firstName","lastName","order_total","class"],"sources":["/Users/hackyourfuture/Desktop/reactWorkSpace/react-ecommerce/react-ecommerce/react-frontend/src/pages/PaymentReturnPage.js"],"sourcesContent":["import React, { useContext, useEffect, useState } from \"react\";\nimport { deleteCookie } from \"../helpers/cookiesHelpers\";\nimport { fetchApi } from \"../helpers/fetchHelper\";\nimport { OrderInProcessContext } from \"../contexts/OrderInProcessContext\";\nimport loadingBar from \"../assets/loading-svgrepo-com.svg\";\nimport { apiServer } from \"../environmentVariables\";\n\nexport default function PaymentReturnPage({ errorHandler }) {\n  const { orderContext, handleOrderContext } = useContext(\n    OrderInProcessContext\n  );\n  const [orderStatus, setOrderStatus] = useState(\"pending\");\n\n  useEffect(() => {\n    const intervalId = setInterval(() => {\n      fetchApi(`${apiServer}/api/checkout/status/${orderContext.id}`)\n        .then((res) => {\n          if (res.order_status === \"closed\") {\n            setOrderStatus(res.payment_status);\n            deleteCookie(\"orderInProcess\");\n            clearInterval(intervalId);\n          }\n        })\n        .catch((err) => errorHandler(err));\n    }, 5000);\n  }, []);\n  let totalQuantity = 0;\n  const cartItems = orderContext\n    ? orderContext.Products.map((product) => {\n        totalQuantity += product.OrderDetail.quantity;\n        return (\n          <div className=\"cart-item\">\n            <div className=\"cart-item-left\">\n              <img\n                className=\"cart-product-image\"\n                src={`${apiServer}/api/productImages/${\n                  product.ProductImages[0].path.split(\"/\")[3]\n                }`}\n                alt={product.name}\n              />\n              <div className=\"cart-update\">\n                <p>{product.name}</p>\n\n                <span>{product.OrderDetail.quantity}</span>\n              </div>\n            </div>\n            <span className=\"cart-product-price\">{product.price}</span>\n          </div>\n        );\n      })\n    : [];\n\n  return (\n    <>\n      <div className=\"navbar-space\"></div>\n      <div className=\"order-detail\">\n        <p>Thank you for your shopping...</p>\n        <p>{`Order Id: ${orderContext.id}`}</p>\n        <p>{orderContext.GuestCustomer.firstName}</p>\n        <p>{orderContext.GuestCustomer.lastName}</p>\n      </div>\n      <div className=\"cart-items\">\n        {cartItems}\n        <div className=\"cart-total-container\">\n          <div className=\"cart-total\">\n            <span>Total ({`${totalQuantity} products`})</span>\n            <span>({`${orderContext.order_total}$`})</span>\n          </div>\n          <p className=\"payment-status\">Payment status</p>\n          <br />\n          <p className=\"payment-status\">\n            {\" \"}\n            {orderStatus === \"pending\" ? (\n              <img class=\"loading-bar\" src={loadingBar} alt=\"loading-bar\" />\n            ) : (\n              orderStatus\n            )}\n          </p>\n        </div>\n      </div>\n    </>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}